Exceptions
===========

***1. Дайте определение понятию “исключение”***

**Исключения** - это нештатная ситуация, ошибка во время выполнения программы.

***2. Какова иерархия исключений.***
![](https://cloud.githubusercontent.com/assets/18701152/15581283/4c2f5348-2374-11e6-8fd2-e4de02d2c389.png)
Все классы исключений в Java представляют подтипы класса java.lang.Exception. Класс исключений является подклассом класса Throwable. Помимо класса исключений существует также подкласс ошибок, образовавшихся из класса Throwable.

Класс исключений делится на два основных подкласса: класс IOException и класс RuntimeException.

***3. Можно/нужно ли обрабатывать ошибки jvm?***

```java
try {
   // Защищенный код
}catch(НазваниеИсключения e1) {
   // Блок catch
}
```

***4. Какие существуют способы обработки исключений?***
В самом методе или с использование throws.


***5. О чем говорит ключевое слово throws?***
`throws` - ключевое слово, которое используется для того чтобы показать какие исключения может порадить метод (которые он сам не обрабатывает)

***6. В чем особенность блока finally? Всегда ли он исполняется?***

Блок выполняется всегда, вне зависимости был ли эксепшен или нет. Наилусшее применение блока - освобождение ресурсов. Бывают ситуации , что не будет выполняться.

***7. Может ли не быть ни одного блока catch при отлавливании исключений?***
Написать так можно, но смысла в такой записи нету.

***8. Могли бы вы придумать ситуацию, когда блок finally не будет выполнен?***
```java
try { 
    System.exit(0); 
} catch(Exception e) { 
    e.printStackTrace(); 
} finally { }
```
***9. Может ли один блок catch отлавливать несколько исключений (с одной и разных веток наследований)?***
```java
try {  
 ... 
} catch( IOException | SQLException ex ) {  
  logger.log(ex); 
  throw ex; 
}
```

***10. Что вы знаете об обрабатываемых и не обрабатываемых (catched/uncatched) исключениях?***

`Throwable` и `Exception` и все их наследники (за исключением наследников `Error-а` и `RuntimeException`) — checked
— `Error` и `RuntimeException` и все их наследники — unchecked

`checked exception` = проверяемое исключение, проверяемое компилятором.

***11. В чем особенность RuntimeException?***

`public class RuntimeException extends Exception` — базовый класс для ошибок во время выполнения. Относится к необрабатываемым исключениям (uncatched\unchecked). Как сказано в описании класса — это суперкласс, исключения которого могут быть выброшены во время нормальной работы JVM.

***12. Как написать собственное (“пользовательское”) исключение? Какими мотивами вы будете руководствоваться при выборе типа исключения: checked/unchecked?***

Необходимо унаследоваться от базового класса требуемого типа исключений (например от Exception или RuntimeException).
```java
public class NotFoundException extends RuntimeException {
    public NotFoundException(String message) {
        super(message);
    }
}
```


***13. Какой оператор позволяет принудительно выбросить исключение?***

оператор `throw`
***14. Есть ли дополнительные условия к методу, который потенциально может выбросить исключение?***

Если это проверяемое исключение, то оно должно быть задекларировано в сигнатуре метода.

```java
 public void someMethod() throws Exception {
    }
```
***15. Может ли метод main выбросить исключение во вне и если да, то где будет происходить обработка данного исключения?***

Да, может, обработка будетпроисходить в JVM

***16. Если оператор return содержится и в блоке catch и в finally, какой из них “главнее”?***

Вернется из `finally`

```java
public class TestReturn {
	public static void main(String[] args) {
		   String what =  method();
	        System.out.println(what);
	}
	
	  public static String method() {
	        try {
	        	int a  = 100/0;
	            return "SomeString";
	        } 
	        catch (Exception e) {
	        	return  "Exception";
	        }
	        finally {
	            return "Finally message";
	        }
	    }
}
```

***17. Что вы знаете о OutOfMemoryError?***

Выбрасывается когда JVM не может разместить объект у себя в памяти, а GC  не может освободить. 
![](http://javastudy.ru/wp-content/uploads/2016/01/outOfMemoryTypes-300x84.png)

1. java.lang.OutOfMemoryError: Java heap space
Не хватает места в куче, а именно, в области памяти в которую помещаются объекты, создаваемые программно в вашем приложении. Размер задается параметрами -Xms и -Xmx. Если вы пытаетесь создать объект, а места в куче не осталось, то получаете эту ошибку. Обычно проблема кроется в утечке памяти, коих бывает великое множество, и интернет просто пестрит статьями на эту тему.

2. java.lang.OutOfMemoryError: PermGen space
Данная ошибка возникает при нехватке места в Permanent области, размер которой задается параметрами -XX:PermSize и -XX:MaxPermSize.

3. java.lang.OutOfMemoryError: GC overhead limit exceeded
Данная ошибка может возникнуть как при переполнении первой, так и второй областей. Связана она с тем, что памяти осталось мало и GC постоянно работает, пытаясь высвободить немного места. Данную ошибку можно отключить с помощью параметра -XX:-UseGCOverheadLimit, но, конечно же, её надо не отключать, а либо решать проблему утечки памяти, либо выделять больше объема, либо менять настройки GC.

4. java.lang.OutOfMemoryError: unable to create new native thread

Выбрасывается, когда нет возможности создать еще потоки.

***18. Что вы знаете о SQLException? К какому типу checked или unchecked оно относится, почему?***

SQLException относится к checked исключениям, а значит проверяется на этапе компиляции.

Споры об этом типе исключения идут о том, что разработчику приходится постоянно обрабатывать это исключение в коде, хотя большая часть ошибок возникает во время выполнения программы, т.е., по мнению многих, лучше бы отнести его к unchecked runtime исключениям.

Аргумент Joshua Bloch из Effective Java Second Edition такой: сделав SQLException проверяемым — это попытка заставить разработчиков обработать исключение и обернуть его в новом уровне абстракции.

***19. Что такое Error? В каком случае используется Error. Приведите пример Error’а.***
`OutOfMemoryError` и `StackOverflowError`

***20. Какая конструкция используется в Java для обработки исключений?***

Можно использовать `try-catch-finally` и c 7й Java `try-with-resources`. Первый способ:
```java
try (BufferedReader br =
                   new BufferedReader(new FileReader(path)) ) {
        return br.readLine();
    }
```

***21. Предположим, есть блок try-finally. В блоке try возникло исключение и выполнение переместилось в блок finally. В блоке finally тоже возникло исключение. Какое из двух исключений “выпадет” из блока try-finally? Что случится со вторым исключением?***
Из `finally` 
+ Если было выброшено два (одно в `try` второе в `finally`), то в `finally` проглотит из блока try.
+ Если до блока finally исключение было обработано, то мы можем получить информацию об исключении в блоке try и тем самым не потерять исключение, которое впоследствии может быть перезаписано в finally другим исключением. 

***22. Предположим, есть метод, который может выбросить IOException и FileNotFoundException в какой последовательности должны идти блоки catch? Сколько блоков catch будет выполнено?***

Общее правило — обрабатывать исключения нужно от «младшего» к старшему. Т.е. нельзя поставить в первый блок catch(Exception e) {}, иначе все дальнейшие блоки catch() уже ничего не смогут обработать, т.к. любое исключение будет попадать под ExceptionName extends Exception.

Таким образом сначала нужно обработать  `FileNotFoundException extends IOException`, а затем уже `IOException`.
